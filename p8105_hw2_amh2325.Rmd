---
title: "p8105_hw2_amh2325"
author: "Amanda Howarth"
date: "10/2/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(readxl)
```
## Problem 1
## Import trash_wheels data sheet 1
```{r}
trash_wheels_data =
  read_excel(path = "./data/trash_wheel.xlsx", sheet = 1) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  select(-15, -16, -17) %>%
  mutate(sports_balls = as.integer(sports_balls))
trash_wheels_data
```
## Import precipitation_2018 data
```{r}
precipitation_2018_data = 
  read_excel(path = "./data/trash_wheel.xlsx", sheet = 6, range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = 2018)
precipitation_2018_data
```
## Import precipitation_2017 data
```{r}
precipitation_2017_data = 
  read_excel(path = "./data/trash_wheel.xlsx", sheet = 5, range = "A2:B14") %>%
  janitor::clean_names() %>%
  mutate(year = 2017)
precipitation_2017_data
```
## Merging datasets to form precipiation_join data 
```{r}
precipitation_join = 
  full_join(precipitation_2018_data, precipitation_2017_data) %>%
  mutate(month = as.numeric(month), month = month.name[month])
precipitation_join
```
Problem 1: 

## Problem 2 
## Import pols_month data 
```{r}
pols_month_data = read_csv("./data/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(mon, into = c("year", "month", "day")) %>%
  mutate(month = as.numeric(month), month = month.abb[month]) %>%
  mutate(year = as.numeric(year))%>%
  mutate(president = ifelse(prez_dem, "dem", "gop")) %>%
  select(-prez_dem, -prez_gop, -day)
pols_month_data
```
## Import standard_poor_stock data 
```{r}
standard_poor_stock_data = read_csv("./data/snp.csv") %>%
  janitor::clean_names() %>%
  separate(date, into = c("day", "month", "year")) %>%
  select(year, month, everything(), -day) %>%
  mutate(year = as.numeric(year)) %>%
  mutate(month = as.numeric(month), month = month.abb[month])
standard_poor_stock_data
```

## Import unemployment data 
```{r}
unemployment_data = read_csv("./data/unemployment.csv") %>%
  pivot_longer((Jan:Dec), names_to = "month", values_to ="percent")%>%
  janitor::clean_names()
unemployment_data
```

## Merge standard_poor_stock_data and pols_month_data to form snp_pols_data 
```{r}
snp_pols_data = 
  left_join(pols_month_data, standard_poor_stock_data, by = c("year", "month"))
snp_pols_data
```
## Merge unemployment_data and snp_pols_data into snp_pols_unemp_data 
```{r}
snp_pols_unemp_data = 
    left_join(snp_pols_data, unemployment_data, by = c("year", "month"))
snp_pols_unemp_data
```
## Problem 2
pols_month_data 
standard_poor_stock_data
unemployment_data 
snp_pols_data
snp_pols_unemp_data 

## Problem 3 
## Import baby names data 
```{r}
baby_names_data = read_csv("./data/Popular_Baby_Names.csv") %>%
  distinct() %>%
  janitor::clean_names() %>%
  mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER", "BLACK NON HISP" = "BLACK NON HISPANIC", "WHITE NON HISP" = "WHITE NON HISPANIC")) %>%
  mutate(ethnicity = str_to_lower(ethnicity), gender = str_to_lower(gender), childs_first_name = str_to_lower(childs_first_name))
```
## Producing a table showing the rank in popularity of the name “Olivia” as a female baby name over time; this should have rows for ethnicities and columns for year. 
```{r}
baby_names_data %>%
filter(childs_first_name == "olivia") %>%
  select(-count) %>%
  pivot_wider(names_from = year_of_birth,
              values_from = rank)
```
## Producing a similar table showing the most popular name among male children over time.
```{r}
baby_names_data %>%
filter(gender == "male", rank == 1) %>%
  select(-count) %>%
  pivot_wider(names_from = year_of_birth,
              values_from = rank)
```
## For male, white non-hispanic children born in 2016, produce a scatter plot showing the number of children with a name (y axis) against the rank in popularity of that name (x axis).
```{r}
baby_names_plot = filter(baby_names_data, ethnicity == "white non hispanic", year_of_birth == "2016", gender == "male")
ggplot(baby_names_plot, aes(x = rank, y = count)) + geom_point() 
``` 
